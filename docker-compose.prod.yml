services:
  app-prod:
    build:
      context: .
      dockerfile: Dockerfile.prod
    container_name: gc-scaffold-prod
    ports:
      - "${HTTP_PORT:-80}:80"
      - "${HTTPS_PORT:-443}:443"
    volumes:
      - ssl_certs:/etc/nginx/ssl:ro
    environment:
      - NODE_ENV=production
      - HTTP_PORT=${HTTP_PORT:-80}
      - HTTPS_PORT=${HTTPS_PORT:-443}
      - SSL_ENABLED=${SSL_ENABLED:-true}
      - SSL_CERT_PATH=${SSL_CERT_PATH:-/etc/nginx/ssl/cert.pem}
      - SSL_KEY_PATH=${SSL_KEY_PATH:-/etc/nginx/ssl/key.pem}
    env_file:
      - .env.production
    restart: unless-stopped

volumes:
  ssl_certs:
    external: false

